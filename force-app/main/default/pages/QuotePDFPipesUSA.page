<apex:page showHeader="false" extensions="QuotePDF"
		standardcontroller="Quote" standardstylesheets="false" renderAs="pdf" 
           applybodytag="false" applyhtmltag="false" >
	<head>
        <style>
            @page {
                size: portrait;

                @top-center {
                    content: element(header);
                }
            }



            @page :left {
               
                margin: 140px 0 2.5cm 0;
            }
            @page :right {
             
                margin: 140px 0 2.5cm 0;
            }
            body {
                margin: 0 2.5cm 0 2cm;
                font-family: Arial Unicode MS, Calibri, Geneva, Arial, Helvetica, sans-serif;
                font-size: 12px;
            }
            .heading{
            	text-align: center;
            	font-weight: bold;
            	font-family: Arial Unicode MS Bold, Calibri, Geneva, Arial, Helvetica, sans-serif;
            	font-size: 17px;
            	text-decoration: underline;
                margin-left: 1cm;
                margin-top: 1cm;
                margin-bottom: 0;
            }

            

            .footerheading {
                font-family: Helvetica, sans-serif;
                font-size: 18px;
                color: gray;
                margin-left: 95px;
            }
            .footertext {
                font-family: Geneva, sans-serif;
                font-size: 11px;
                color: gray;
                margin-left: 95px;
            }

            b {
            	font-weight: bold;
            	font-family: Arial Unicode MS Bold, Calibri, Geneva, Arial, Helvetica, sans-serif;
            }
            p {
                margin: 0;
            }
            caption {
                text-align: left;
                padding-top: 30px;
            }
            table {
            	border-collapse: collapse;
            	width: 100%;
            	page-break-inside: avoid;

            }
            td, th {
            	text-align:center; 
            }
            div.header {
				position: running(header);
            }
            div.header:after {
            	background: url('{!$Resource.Logo100}') no-repeat center center;
			    height: 100px;
			    width: 100px;
			    text-align: center;
			    position: absolute;
			    top: 45px;
			    right: 70px;
			    content: " ";
			    display: block;
            }

           

            tr.tableHeader th{
            	background-color: gray;
            	color: white;
            }
            tr.odd {
            	background-color: #ffffff;
            	z-index: 10;
            }
            tr.even {
            	background-color: #efefef;
            	z-index: 10;
            }
            tr.totals > td{
            	border-top: 1px solid black;
            	border-right: none;
            }
            td {
            	/*position: relative;
            	z-index: 10;*/
            	border-right: 1px solid black;
            	/*padding: 0px;
            	margin: 0px;*/
            }
            /*td:after{
			    content: " ";
			    width: 1px;
			    height: 100%;
			    position: absolute;
			    right: 0;
			    top: 0;
			    background-color: black;
			    display: block;
			    z-index: 999999;
            }*/
            td.lastCell{
				border-right: none;
            }
            td.alignRight {
            	text-align: right;
            }
            .grandTotalCapture{
            	background-color: transparent!important;
            	border-left:  0px solid black!important;
            	border-top: 0px solid black!important;
            	border-bottom:  0px solid black!important;
            	border-right: 1px solid black!important;
            	color: black!important;
            	text-align: right!important;
            }
            table.grandTotals tr .allBorders{
            	border:1px solid black;
            }
            .fixedWidth {
            	width:100px;
            }
            .tabulation {
                margin-left: 2cm;
            }
            th {
                min-width: 1cm;
            }
        </style>
    </head>
    <body>
    	<div class="header"></div>


        <b>Ref: {!numPdfs}</b><br/>
		<b>Date of Offer:  
		<apex:outputtext value="{0, date, MMMM dd, yyyy}">
            <apex:param value="{!TODAY()}" />
        </apex:outputtext>
        </b>
		<br/><br/><br/>
		<div class="heading">Commercial &amp; Technical Offer</div>
        <br/><br/><br/>
        <b>Subject: {!quote.Name}</b><br/>
		<b>Ref: {!quote.QuoteNumber}</b><br/>
        <br/>
		<br/>
        <apex:outputText escape="false" value="<b>Kind Attn:</b> {!quote.Contact.Name}"/>
        <br/><br/>
		<br/><br/>
		
        <apex:outputText escape="false" value="Dear {!sirName},<br/><br/><br/>We thankfully acknowledge the receipt of your enquiry &amp;
                we are pleased to submit our offer for the supply according to standard requirements with the attached details.<br/>
                We hope you will find our offer complete and competitive. We look forward to receiving your response.<br/>
                Thanking and assuring you best of our services at all times.<br/><br/><br/><br/>Best Regards," /><br/>
<br/><br/><br/>
        <apex:outputText escape="false" value="{!curUser.Name}<br/>
                Regional Sales Manager<br/>
                Tel: {!curUser.Phone}<br/>
                Email: {!userEmail}<br/>
                www.interpipe.biz"/><br/><br/><br/>
            <br/><br/><br/><br/><br/><br/><br/><br/><br/><br/>
		<apex:variable var="cnt" value="{!1}" />
		<apex:variable var="countTable" value="{!0}" />
		<apex:variable var="showNotForMT" value="{true}"/>
		<apex:variable var="labelToApiMap" value="{!apinameToLabelMap}"/>
		<apex:variable var="keyList" value="{!groupKeys}"/>
		<apex:variable value="{!0}" var="index" />
		
		

		<!-- Iterate over groups of line items -->
		<apex:repeat var="tableI" value="{!listOpps}">
			<apex:variable var="show" value="{!tableI[0].Product2.Type__c=='Tube'}" />
            <apex:variable var="showLBFT" value="{!showLB_FTForTables[countTable]}" />
            <apex:variable var="showWT" value="{!showWTForTables[countTable]}" />
			<apex:variable var="showNotForMT" value="{!tableI[0].InquiryUnit__c!='34'}" />
			<div style="display:{!if(show,"","none")};" >

				<!-- Table for tubes -->
				<table cellpadding="0">	
					<caption>	
						<b>Product Description &amp; prices:</b>
					</caption>	
					<tr class="tableHeader">
						<th rowspan="2">#</th>					
						<th>OD</th>
						<th>WT</th>				
						<th>Weight<br/> (PPF)</th>	
		                <th>Length</th>
		                <th rowspan="2">End</th>				
		                <th rowspan="2">Steel<br/>Gr</th>			
		                <th>Quantity</th>					
		                <th>Price Delivery At</th>
		                <th class="fixedWidth">Total<br/>Value</th>
		            </tr>
		            <tr>
                        <th>inch</th>
                        <th>inch</th>
                        <th>lb/ft</th>
                        <th>m</th>
                        <th>{!metricName}</th>
                        <th>{!quote.Opportunity.CurrencyISOCode}/{!metricName}</th>
                        <th>{!quote.Opportunity.CurrencyISOCode}</th>
                    </tr>
		        	<!-- Iterate over rows -->
		        	<apex:variable var="localCounter" value="{!1}"/>
					<apex:repeat value="{!tableI}" var="line">
			            <tr class="{!if(mod(localCounter,2)==0, 'odd', 'even')}">
			            	<td><apex:OutputText value="{!cnt}"/></td>					
			              	<td>{!line.TubeOD__r.OD_inch__c}</td>		
			              	<td>{!line.TubeWT__r.WT_inch__c}</td>			
			              	<td>{!line.Weight_ppf__c}</td>	
			              	<td>{!line.TubeLengthSize__r.ShortName__c}</td>
			              	<td>{!line.TubeEnds__r.ShortName__c}</td>
                            <td>{!line.SteelGrade__r.ShortName__c}</td>	
                            <td>{!oliIdToFormattedDataMap[line.Id][$CurrentPage.parameters.Quantity]}</td>
			              	
			              	<td>{!oliIdToFormattedDataMap[line.Id].InquiryUnitPrice__c}</td>

			              	<td class="lastCell alignRight fixedWidth">{!oliIdToFormattedDataMap[line.Id].TotalPrice}</td>
			            </tr>
			            <apex:variable var="cnt" value="{!if(show,cnt+1,cnt)}"/>
			            <apex:variable var="localCounter" value="{!localCounter+1}"/>       
			        </apex:repeat>
		        </table>

		        <br/><br/>
	        </div>
			<apex:variable var="countTable" value="{!countTable+1}"/>
		</apex:repeat>
		

        <b>Pipe manufacturing:</b>
        <ul Style="list-style-type:none">
            <li>-<b>  Location: </b> <apex:outputText escape="false" value="{!quote.Country_of_Origin__c}" /> </li>
            <li>-<b>  Standards: </b> <apex:outputText value="{!tolerance}" />  </li>
        </ul>
        <b>Pipes marking: </b>
        <apex:outputText escape="false" value="{!quoteMarking}" /><br/>
        <b>Pipes packing: </b>
        <apex:outputText escape="false" value="{!quotePacking}" /><br/>
        <b>Pipes end protectors: </b>
        <apex:outputText escape="false" value="{!quote.Protection__c}" /><br/>
        <b>Pipes inspection: </b>
        <apex:outputText escape="false" value="{!quoteThirdPartyInspection}" /><br/>
        <b>Invoicing and shipping tolerance: </b>
        <apex:outputText escape="false" value="{!quote.Invoicing__c} {!quote.Special_Shipping_Requirements__c}" /><br/>
        <b>Delivery terms and conditions: </b>
        <apex:outputText escape="false" value="{!quote.DeliveryTerms__r.Name}" /><br/>
        <ul Style="list-style-type:none" Class="tabulation">
            <li>-	Advise any special shipping requirements for confirmation.</li>
            <li>-	Shipping marks: to be advised in purchase order</li>
            <li>-	Shipping marks: {!shippingMarks}</li>
        </ul>
        <b>Payment Terms: </b>
        <apex:outputText escape="false" value="{!quotePaymentTermsNameFull}" /><br/>
        <b>Additional Terms: </b><br/>
        <ul Style="list-style-type:none">
            <li>Taxes: Buyer agrees to provide Seller with Tax Exemption Resale Certificate in advance of, or attached to 
                Buyer's purchase order. Otherwise, Buyer is responsible for any/all applicable and/or associated sales tax 
                related to the transaction.</li>
            <li>- Interpipe Terms &amp; Conditions are integral part of our proposal (refer to the enclosed document).
                Attached, Interpipe Terms &amp; Conditions apply. Interpipe Terms &amp; Conditions supersede any past, 
                present or future written agreements regarding terms and conditions related to transactions between 
                Seller and Buyer, unless and until alterations, amendments, additions or deletions have been acknowledged 
                and approved in writing by Interpipe.
            </li>
            <li>- In the event of termination of the Purchase Order for convenience, SELLER should be compensated 
                not only for the amount of Goods delivered and accepted by BUYER but also for the costs of pipes 
                that are still in possession of the SELLER or in the manufacturing process in accordance with a 
                pre-established schedule of prices. To this extent, BUYER will pay to SELLER: (1) the net amount due, 
                ascertained in respect to the pipes delivered and accepted by BUYER up to the date of termination; 
                plus (2) the amounts resulting from the following percentages of the prices agreed for those pipes 
                requested by BUYER and are still in possession of the SELLER or in the manufacturing process:
                <ol Style="list-style-type: lower-alpha; ">
                    <li>Material before steel making 10%</li>
                    <li>Material before rolling 40%</li>
                    <li>Material before heat treatment 70%</li>
                    <li>Material before finishing 90%</li>
                    <li>Finished Product 100%</li>
                    <li>The materials for which BUYER pays under this Article shall be made available EXW for withdrawal
                         during thirty (30) day period from receipt of the notice of availability. The offer is for total quantity,
                         if partial quantity is ordered, we reserve the right to accept or reject the order.</li>
                </ol>    
            </li>
            <li>- Delivery time is given considering current mill booking position a firm delivery schedule 
                will be mutually discussed &amp; agreed upon at the time of contract signing. </li>
            <li>- Any amendments of a.m. conditions must be subject to prior approval </li>
        </ul><br/>
        <br/><b>Offer Validity: </b>
        <apex:outputText escape="false" value="{!expirationDateDays} days from the date of offer" /><br/><br/>
    </body>
</apex:page>