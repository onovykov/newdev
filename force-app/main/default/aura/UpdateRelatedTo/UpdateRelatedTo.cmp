<aura:component implements="force:lightningQuickActionWithoutHeader,force:hasRecordId" controller="EmailMessageController" >
    <!-- public attributes -->
    <aura:attribute name="recordId" type="String" />
    
    <!-- internal attributes -->
    <aura:attribute name="selectedType" type="String" default="" access="private" />
    <aura:attribute name="relatedToId" type="String" default="" access="private" />
    
    <!-- handlers -->
    <aura:handler name="init" value="{!this}" action="{!c.doInit}"/>
    
    <!-- markup -->
    <style>
        .cuf-content {
        	padding: 0 0rem !important;
        }
        .slds-p-around--medium {
        	padding: 0rem !important;
        }
        .slds-modal__content {
            overflow-y: hidden !important;
            height: unset !important;
            max-height: unset !important;
        }        
        .modal-body {
        	margin: 10px;
        }
    </style>
    
    <div class="slds-col modal-header slds-modal__header">
        <h2 class="title slds-text-heading--medium">Update Related To</h2>
    </div>
    
    <div class="slds-col modal-body scrollable slds-p-around--medium" style="height: 200px; max-height: 400px; overflow-y: auto !important">
        <section>
            <lightning:spinner aura:id="mySpinner" class="mySpinner slds-hide" size="large" />
            <lightning:select aura:id="select" name="select" label="Select Related To type" value="{!v.selectedType}" onchange="{!c.changeType}">
                <option value="">--None--</option>
                <option value="Account">Account</option>
                <option value="Opportunity">Opportunity</option>
            </lightning:select>    
            
            <aura:if isTrue="{! v.selectedType == 'Account'  }">
                <c:inputLookup label="Account" object="Account" searchField="Name" placeholder="Select an option"
                               iconName="standard:account" subtitleField="Industry" order="Name" limit="5"
                               loadingMessage="Loading..." errorMessage="Invalid input" value="{!v.relatedToId}"
                               showRecentRecords="true" />
            </aura:if>
            
            <aura:if isTrue="{! v.selectedType == 'Opportunity'  }">
                <c:inputLookup label="Opportunity" object="Opportunity" searchField="Name" placeholder="Select an option"
                               iconName="standard:opportunity" subtitleField="Name" order="Name" limit="5"
                               loadingMessage="Loading..." errorMessage="Invalid input" value="{!v.relatedToId}"
                               showRecentRecords="true" />
            </aura:if>
        </section>
    </div>
    
    <div class="slds-col modal-footer slds-modal__footer">        
        <lightning:button variant="neutral" label="Cancel" onclick="{! c.cancelClick }" />      
        <lightning:button variant="brand" label="Save" onclick="{! c.saveClick }" />
    </div>
             
</aura:component>